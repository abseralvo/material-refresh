(function(){"use strict";!function(e){function s(s){if(s=s||{},g=s.scrollEl?s.scrollEl:F?g:document,y=e(g),U=s.onBegin,H=s.onEnd,M=s.maxTime||M,P=s.nav||P,O=s.scrollAtTop||!0,e(P).css("transition","height 0.5s"),0===e("#muirefresh").length&&o(),m=e("#muiRefresh"),p=e(".mui-spinner-wrapper",m),h=e(".mui-arrow-wrapper",m),v=e(".mui-arrow-main",m),!d()){m.addClass("mui-refresh-nav"),S=e(P).height()+20,e(P).offset()&&(j=e(P).offset().top,"fixed"!==e(P).css("position")&&(S+=j),m.css("top",j+"px"));var n=e(P).css("z-index");m.css("z-index",n-1)}s.index&&m.css("z-index",~~s.index),s.top&&m.css("top",s.top),s.theme?m.addClass(s.theme):m.addClass(T),m.addClass(b),s.freeze||l()}function o(){document.body.insertAdjacentHTML("beforeend",G)}function n(e){F&&g==document.body?I.top=window.scrollY:g!=document?I.top=document.querySelector(g).scrollTop:I.top=(document.documentElement||document.body.parentNode||document.body).scrollTop,I.top>0||C||(w=S+z,m.show(),e=e.originalEvent||e,e.touches[0]&&(I.x1=e.touches[0].pageX,X=I.y1=e.touches[0].pageY))}function t(e){var s,o,n=(new Date).getTime();if(e=e.originalEvent||e,!(I.top>0||C)&&e.touches&&1===e.touches.length&&(!O||0===document.body.scrollTop)){if(s=e.touches[0],I.x2=s.pageX,I.y2=s.pageY,o=I.y2-I.y1,I.y2-X+B>0){if(e.preventDefault(),n-Q<90)return;if(!(w<S-j+A))return void u();w+=o,r(w)}I.y1=s.pageY,Q=n}}function i(s){e(g).css("margin-top",0),I.top>0||C||(w>S-j+D?u():c())}function c(){var e=S+z;d()?(m.css("top",e+"px"),m.css("-webkit-transform","scale(0)")):m.css("top",j+"px"),setTimeout(function(){C||(m.css("opacity",0),m.hide())},300)}function r(s){var o=40,n=s/o>1?1:s/o<0?0:s/o,t=S+z+s;d()&&m.css("-webkit-transform","scale("+n+")"),e(P).css("height",s),m.css("opacity",n),m.css("top",t+"px"),v.css("-webkit-transform","rotate("+-(3*s)+"deg)")}function u(){if(C=!0,e(P).css("height",0),k&&"function"==typeof q?q():"function"==typeof U&&U(),m.css("opacity",1),k)m.addClass(b),m.css("-webkit-transform","scale(1)");else{var s=S+Y-20;d()||(s+=R),m.css("top",s+"px")}h.hide(),p.show(),N=setTimeout(a,M)}function a(){E=!0,m.addClass(x),p.hide(),setTimeout(function(){m.removeClass(x),m.hide(),c(),h.show(),C=!1,E=!1,k&&"function"==typeof L?L():"function"==typeof H&&H(),k=!1},500)}function d(){return 0===e(P).length}function l(){y.on("touchstart",n),y.on("touchmove",t),y.on("touchend",i)}function f(){y.off("touchstart",n),y.off("touchmove",t),y.off("touchend",i)}var m,p,h,v,w,y=e(document.body),g=document.body,x="mui-refresh-noshow",b="mui-refresh-main-animat",T="mui-blue-theme",C=!1,E=!1,k=!1,z=-85,Y=0,A=65,D=-25,R=20,X=0,j=0,B=2,M=6e3,S=60,U=null,q=null,H=null,L=null,N=null,O=null,P="",Q=(new Date).getTime(),F=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),G='<div id="muiRefresh" class="mui-refresh-main">            <div class="mui-refresh-wrapper ">                <div class="mui-arrow-wrapper">                    <div class="mui-arrow-main"></div>                </div>                <div class="mui-spinner-wrapper" style="display:none;">                    <div class="mui-spinner-main" >                        <div class="mui-spinner-left">                            <div class="mui-half-circle"></div>                        </div>                        <div class="mui-spinner-right">                            <div class="mui-half-circle"></div>                        </div>                    </div>                </div>            </div>        </div>',I={top:0,x1:0,x2:0,y1:0,y2:0};s.resolve=function(){!E&&N&&(clearTimeout(N),N=null,a())},s.destroy=function(){f(),m.remove()},s.refresh=function(e){if(!C){var s=S+Y-20;C=!0,k=!0,e=e||{},q=e.onBegin,L=e.onEnd,d()||(s+=R),m.show(),m.removeClass(b),m.css("top",s+"px"),m.css("-webkit-transform","scale(0.01)"),setTimeout(u,60)}},s.unbindEvents=function(){f()},s.bindEvents=function(){l()},window.mRefresh=s}(window.jQuery)}).call(this);